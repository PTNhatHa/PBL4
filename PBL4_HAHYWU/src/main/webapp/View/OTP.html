<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OTP</title>
    <link rel="stylesheet" href="View/styles.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <Script language="JavaScript">
        function checksend() {
        	document.getElementById("OTPAlertp").innerHTML = "";
        	document.getElementById("warning").innerHTML = "";
        	var email = document.getElementById("email").value;
            var xmlhttp = new XMLHttpRequest();
            xmlhttp.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {
                    document.getElementById("OTPAlertp").innerHTML = this.responseText;
                    if(this.responseText == "OTP has already sent to your email! Please check it!") {
                    	document.getElementById("email").readOnly = true;
                        document.getElementById("sendotp").hidden = false;
                        document.getElementById("otp").value = "";
                        document.getElementById("buttonSendOTP").value = "Send OTP again";
                        document.getElementById("warning").hidden = false;
                        document.getElementById("warning").innerHTML = "Your otp code will be effective within only 2 minutes!";
                    }
                }
            };
            xmlhttp.open("GET", "?sendOTP=1&email="+email, true);
            xmlhttp.send();
        }
        
		function checkOTPagain() {
			var otp = document.getElementById("otp").value;
			var email = document.getElementById("email").value;
            var xmlhttp = new XMLHttpRequest();
            xmlhttp.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {
                    document.getElementById("warning").innerHTML = this.responseText;
                    if(this.responseText == "") {
                    	location.href = "GrabServlet?signupform=1&email="+email;
                    }
                }
            };
            xmlhttp.open("GET", "?checkOTP=1&otp="+otp, true);
            xmlhttp.send();
		}
    </Script>
</head>
<body>
    <form action="" method="">
        <div class="OTPall">
            <input class="btn-close" data-bs-dismiss="modal" id="Button-close" type="button" value="" style="background-image: url(img/Close.png); position: relative; top: 21px; right: -465px;">
            <div class="OTP">
                <p class="p-30">Enter your email</p>
                <div class="entermail">
                    <input style="width: 70%;" type="email" id="email" name="email" class="inputtext" placeholder="name@example.com" required="required">
                    <input type="button" name="sendOTP" class="Button-bl-wh" id="buttonSendOTP" value="Send OTP" onclick="checksend()">
                    
                    <span class="OTPAlert" id="OTPAlert"><p id="OTPAlertp"></p> </span>
                </div>
            </div>
            <div id="sendotp" class="OTP" hidden>
                <div class="line"><hr></div>
                <p class="p-30">Enter your OTP</p>  
                <div class="entermail">
                    <input style="width: 70%;" type="text" class="inputtext" name="otp" id="otp" placeholder="Enter your OTP">
                    <input type="button" class="Button-bl-wh" name="checkOTP" id="buttonSend" value="Send" onclick="checkOTPagain()">
                </div>
                <span class="warning" id="warning" hidden> </span>
            </div>
        </div>
    </form>
</body>
</html>
